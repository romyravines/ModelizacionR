<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.6 Práctica en R | Modelización en R</title>
  <meta name="description" content="Curso-taller preparado para profesionales analiticos." />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="4.6 Práctica en R | Modelización en R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Curso-taller preparado para profesionales analiticos." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.6 Práctica en R | Modelización en R" />
  
  <meta name="twitter:description" content="Curso-taller preparado para profesionales analiticos." />
  

<meta name="author" content="Aula Innova. Innova-tsn" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="metodos-de-re-muestreo.html">
<link rel="next" href="regresion-lineal.html">
<script src="assets/jquery-2.2.3/jquery.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="assets/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="assets/proj4js-2.3.15/proj4.js"></script>
<link href="assets/highcharts-7.0.1/css/motion.css" rel="stylesheet" />
<link href="assets/highcharts-7.0.1/css/htmlwdgtgrid.css" rel="stylesheet" />
<script src="assets/highcharts-7.0.1/highcharts.js"></script>
<script src="assets/highcharts-7.0.1/highcharts-3d.js"></script>
<script src="assets/highcharts-7.0.1/highcharts-more.js"></script>
<script src="assets/highcharts-7.0.1/modules/stock.js"></script>
<script src="assets/highcharts-7.0.1/modules/map.js"></script>
<script src="assets/highcharts-7.0.1/modules/annotations.js"></script>
<script src="assets/highcharts-7.0.1/modules/boost.js"></script>
<script src="assets/highcharts-7.0.1/modules/data.js"></script>
<script src="assets/highcharts-7.0.1/modules/drag-panes.js"></script>
<script src="assets/highcharts-7.0.1/modules/drilldown.js"></script>
<script src="assets/highcharts-7.0.1/modules/item-series.js"></script>
<script src="assets/highcharts-7.0.1/modules/offline-exporting.js"></script>
<script src="assets/highcharts-7.0.1/modules/overlapping-datalabels.js"></script>
<script src="assets/highcharts-7.0.1/modules/exporting.js"></script>
<script src="assets/highcharts-7.0.1/modules/export-data.js"></script>
<script src="assets/highcharts-7.0.1/modules/funnel.js"></script>
<script src="assets/highcharts-7.0.1/modules/heatmap.js"></script>
<script src="assets/highcharts-7.0.1/modules/treemap.js"></script>
<script src="assets/highcharts-7.0.1/modules/sankey.js"></script>
<script src="assets/highcharts-7.0.1/modules/solid-gauge.js"></script>
<script src="assets/highcharts-7.0.1/modules/streamgraph.js"></script>
<script src="assets/highcharts-7.0.1/modules/sunburst.js"></script>
<script src="assets/highcharts-7.0.1/modules/vector.js"></script>
<script src="assets/highcharts-7.0.1/modules/wordcloud.js"></script>
<script src="assets/highcharts-7.0.1/modules/xrange.js"></script>
<script src="assets/highcharts-7.0.1/modules/tilemap.js"></script>
<script src="assets/highcharts-7.0.1/modules/venn.js"></script>
<script src="assets/highcharts-7.0.1/modules/gantt.js"></script>
<script src="assets/highcharts-7.0.1/modules/timeline.js"></script>
<script src="assets/highcharts-7.0.1/modules/parallel-coordinates.js"></script>
<script src="assets/highcharts-7.0.1/plugins/grouped-categories.js"></script>
<script src="assets/highcharts-7.0.1/plugins/motion.js"></script>
<script src="assets/highcharts-7.0.1/plugins/multicolor_series.js"></script>
<script src="assets/highcharts-7.0.1/custom/reset.js"></script>
<script src="assets/highcharts-7.0.1/custom/symbols-extra.js"></script>
<script src="assets/highcharts-7.0.1/custom/text-symbols.js"></script>
<script src="assets/highchart-binding-0.7.0/highchart.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Presentación</a></li>
<li class="part"><span><b>I MODELOS ANALÍTICOS</b></span></li>
<li class="chapter" data-level="1" data-path="modelizacion.html"><a href="modelizacion.html"><i class="fa fa-check"></i><b>1</b> Modelizar</a><ul>
<li class="chapter" data-level="1.1" data-path="modelizar.html"><a href="modelizar.html"><i class="fa fa-check"></i><b>1.1</b> ¿Qué es Modelizar?</a></li>
<li class="chapter" data-level="1.2" data-path="que-es-un-modelo-analitico.html"><a href="que-es-un-modelo-analitico.html"><i class="fa fa-check"></i><b>1.2</b> ¿Qué es un modelo analítico?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tipos-de-problemas.html"><a href="tipos-de-problemas.html"><i class="fa fa-check"></i><b>2</b> Tipos de Problemas</a><ul>
<li class="chapter" data-level="2.1" data-path="clasemodelos.html"><a href="clasemodelos.html"><i class="fa fa-check"></i><b>2.1</b> Enfoques de Modelización</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="catalogo-de-tecnicas.html"><a href="catalogo-de-tecnicas.html"><i class="fa fa-check"></i><b>3</b> Catálogo de Técnicas</a><ul>
<li class="chapter" data-level="3.1" data-path="tecnicas-de-clustering.html"><a href="tecnicas-de-clustering.html"><i class="fa fa-check"></i><b>3.1</b> Técnicas de <em>Clustering</em></a></li>
<li class="chapter" data-level="3.2" data-path="tecnicas-de-clasificacion.html"><a href="tecnicas-de-clasificacion.html"><i class="fa fa-check"></i><b>3.2</b> Técnicas de Clasificación</a></li>
<li class="chapter" data-level="3.3" data-path="tecnicas-de-regresion.html"><a href="tecnicas-de-regresion.html"><i class="fa fa-check"></i><b>3.3</b> Técnicas de Regresión</a></li>
<li class="chapter" data-level="3.4" data-path="tecnicas-de-reduccion-de-dimension.html"><a href="tecnicas-de-reduccion-de-dimension.html"><i class="fa fa-check"></i><b>3.4</b> Técnicas de Reducción de Dimensión</a></li>
<li class="chapter" data-level="3.5" data-path="otras-tecnicas.html"><a href="otras-tecnicas.html"><i class="fa fa-check"></i><b>3.5</b> Otras ‘Técnicas’</a></li>
<li class="chapter" data-level="3.6" data-path="que-tecnica-utilizar.html"><a href="que-tecnica-utilizar.html"><i class="fa fa-check"></i><b>3.6</b> ¿Qué técnica utilizar?</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="evaluacion-de-modelos.html"><a href="evaluacion-de-modelos.html"><i class="fa fa-check"></i><b>4</b> Evaluación de modelos</a><ul>
<li class="chapter" data-level="4.1" data-path="diagnosis-de-negocio.html"><a href="diagnosis-de-negocio.html"><i class="fa fa-check"></i><b>4.1</b> Diagnosis de Negocio</a></li>
<li class="chapter" data-level="4.2" data-path="evaluacion-en-respuesta-binaria.html"><a href="evaluacion-en-respuesta-binaria.html"><i class="fa fa-check"></i><b>4.2</b> Evaluación en Respuesta Binaria</a><ul>
<li class="chapter" data-level="4.2.1" data-path="evaluacion-en-respuesta-binaria.html"><a href="evaluacion-en-respuesta-binaria.html#clasificacion"><i class="fa fa-check"></i><b>4.2.1</b> Clasificación</a></li>
<li class="chapter" data-level="4.2.2" data-path="evaluacion-en-respuesta-binaria.html"><a href="evaluacion-en-respuesta-binaria.html#medidas-de-desigualdad"><i class="fa fa-check"></i><b>4.2.2</b> Medidas de desigualdad</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="evaluacion-en-respuesta-continua.html"><a href="evaluacion-en-respuesta-continua.html"><i class="fa fa-check"></i><b>4.3</b> Evaluación en Respuesta Continúa</a><ul>
<li class="chapter" data-level="4.3.1" data-path="evaluacion-en-respuesta-continua.html"><a href="evaluacion-en-respuesta-continua.html#modelos-de-regresion"><i class="fa fa-check"></i><b>4.3.1</b> Modelos de Regresión</a></li>
<li class="chapter" data-level="4.3.2" data-path="evaluacion-en-respuesta-continua.html"><a href="evaluacion-en-respuesta-continua.html#modelos-de-series-temporales"><i class="fa fa-check"></i><b>4.3.2</b> Modelos de Series temporales</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="evaluacion-en-clustering.html"><a href="evaluacion-en-clustering.html"><i class="fa fa-check"></i><b>4.4</b> Evaluación en <em>Clustering</em></a><ul>
<li class="chapter" data-level="4.4.1" data-path="evaluacion-en-clustering.html"><a href="evaluacion-en-clustering.html#silueta"><i class="fa fa-check"></i><b>4.4.1</b> Silueta</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="metodos-de-re-muestreo.html"><a href="metodos-de-re-muestreo.html"><i class="fa fa-check"></i><b>4.5</b> Métodos de re-muestreo</a><ul>
<li class="chapter" data-level="4.5.1" data-path="metodos-de-re-muestreo.html"><a href="metodos-de-re-muestreo.html#training-testing"><i class="fa fa-check"></i><b>4.5.1</b> Training &amp; testing</a></li>
<li class="chapter" data-level="4.5.2" data-path="metodos-de-re-muestreo.html"><a href="metodos-de-re-muestreo.html#cross-validation"><i class="fa fa-check"></i><b>4.5.2</b> Cross validation</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="practica-en-r.html"><a href="practica-en-r.html"><i class="fa fa-check"></i><b>4.6</b> Práctica en R</a><ul>
<li class="chapter" data-level="4.6.1" data-path="practica-en-r.html"><a href="practica-en-r.html#preparacion-de-los-datos"><i class="fa fa-check"></i><b>4.6.1</b> Preparación de los datos</a></li>
<li class="chapter" data-level="4.6.2" data-path="practica-en-r.html"><a href="practica-en-r.html#clasificacion-1"><i class="fa fa-check"></i><b>4.6.2</b> Clasificación</a></li>
<li class="chapter" data-level="4.6.3" data-path="practica-en-r.html"><a href="practica-en-r.html#regresion"><i class="fa fa-check"></i><b>4.6.3</b> Regresión</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Modelos Estadísticos</b></span></li>
<li class="chapter" data-level="5" data-path="regresion-lineal.html"><a href="regresion-lineal.html"><i class="fa fa-check"></i><b>5</b> Regresión Lineal</a><ul>
<li class="chapter" data-level="5.1" data-path="que-es-un-modelo-de-regresion.html"><a href="que-es-un-modelo-de-regresion.html"><i class="fa fa-check"></i><b>5.1</b> ¿Qué es un Modelo de Regresión?</a><ul>
<li class="chapter" data-level="5.1.1" data-path="que-es-un-modelo-de-regresion.html"><a href="que-es-un-modelo-de-regresion.html#ver-tambien"><i class="fa fa-check"></i><b>5.1.1</b> Ver también:</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="practica-en-r-1.html"><a href="practica-en-r-1.html"><i class="fa fa-check"></i><b>5.2</b> Práctica en R</a><ul>
<li class="chapter" data-level="5.2.1" data-path="practica-en-r-1.html"><a href="practica-en-r-1.html#regresion-lineal-simple"><i class="fa fa-check"></i><b>5.2.1</b> Regresión lineal simple</a></li>
<li class="chapter" data-level="5.2.2" data-path="practica-en-r-1.html"><a href="practica-en-r-1.html#regresion-lineal-multiple"><i class="fa fa-check"></i><b>5.2.2</b> Regresión lineal múltiple</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="regresion-logistica.html"><a href="regresion-logistica.html"><i class="fa fa-check"></i><b>6</b> Regresión Logística</a><ul>
<li class="chapter" data-level="6.1" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html"><i class="fa fa-check"></i><b>6.1</b> Modelos Lineales Generalizados</a></li>
<li class="chapter" data-level="6.2" data-path="modelo-logit.html"><a href="modelo-logit.html"><i class="fa fa-check"></i><b>6.2</b> Modelo Logit</a></li>
<li class="chapter" data-level="6.3" data-path="modelo-probit.html"><a href="modelo-probit.html"><i class="fa fa-check"></i><b>6.3</b> Modelo Probit</a></li>
<li class="chapter" data-level="6.4" data-path="practica-en-r-2.html"><a href="practica-en-r-2.html"><i class="fa fa-check"></i><b>6.4</b> Práctica en R</a><ul>
<li class="chapter" data-level="6.4.1" data-path="practica-en-r-2.html"><a href="practica-en-r-2.html#otros-ejemplos"><i class="fa fa-check"></i><b>6.4.1</b> Otros ejemplos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="series-temporales.html"><a href="series-temporales.html"><i class="fa fa-check"></i><b>7</b> Series Temporales</a><ul>
<li class="chapter" data-level="7.1" data-path="que-es-una-serie-temporal.html"><a href="que-es-una-serie-temporal.html"><i class="fa fa-check"></i><b>7.1</b> ¿Qué es una Serie Temporal?</a></li>
<li class="chapter" data-level="7.2" data-path="herramientas-de-analisis.html"><a href="herramientas-de-analisis.html"><i class="fa fa-check"></i><b>7.2</b> Herramientas de Análisis</a><ul>
<li class="chapter" data-level="7.2.1" data-path="herramientas-de-analisis.html"><a href="herramientas-de-analisis.html#autocorrelacion-acf-y-pacf"><i class="fa fa-check"></i><b>7.2.1</b> Autocorrelación (acf y pacf)</a></li>
<li class="chapter" data-level="7.2.2" data-path="herramientas-de-analisis.html"><a href="herramientas-de-analisis.html#operadores-del-tiempo"><i class="fa fa-check"></i><b>7.2.2</b> Operadores (del Tiempo)</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="alisado-exponencial.html"><a href="alisado-exponencial.html"><i class="fa fa-check"></i><b>7.3</b> Alisado Exponencial</a></li>
<li class="chapter" data-level="7.4" data-path="arima.html"><a href="arima.html"><i class="fa fa-check"></i><b>7.4</b> ARIMA</a><ul>
<li class="chapter" data-level="7.4.1" data-path="arima.html"><a href="arima.html#parte-ar-autorregresiva"><i class="fa fa-check"></i><b>7.4.1</b> Parte AR (Autorregresiva)</a></li>
<li class="chapter" data-level="7.4.2" data-path="arima.html"><a href="arima.html#parte-ma-medias-moviles"><i class="fa fa-check"></i><b>7.4.2</b> Parte MA (Medias Móviles)</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="funciones-de-transferencia.html"><a href="funciones-de-transferencia.html"><i class="fa fa-check"></i><b>7.5</b> Funciones de Transferencia</a></li>
<li class="chapter" data-level="7.6" data-path="practica-en-r-3.html"><a href="practica-en-r-3.html"><i class="fa fa-check"></i><b>7.6</b> Práctica en R</a><ul>
<li class="chapter" data-level="7.6.1" data-path="practica-en-r-3.html"><a href="practica-en-r-3.html#ver-tambien-1"><i class="fa fa-check"></i><b>7.6.1</b> Ver también</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="a-manera-de-nota-final.html"><a href="a-manera-de-nota-final.html"><i class="fa fa-check"></i><b>7.7</b> A manera de nota final</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="aprendizaje-supervisado.html"><a href="aprendizaje-supervisado.html"><i class="fa fa-check"></i><b>8</b> Aprendizaje Supervisado</a><ul>
<li class="chapter" data-level="8.1" data-path="arboles-de-decision.html"><a href="arboles-de-decision.html"><i class="fa fa-check"></i><b>8.1</b> Árboles de decisión</a><ul>
<li class="chapter" data-level="8.1.1" data-path="arboles-de-decision.html"><a href="arboles-de-decision.html#en-r"><i class="fa fa-check"></i><b>8.1.1</b> En R</a></li>
<li class="chapter" data-level="8.1.2" data-path="arboles-de-decision.html"><a href="arboles-de-decision.html#ventajas-y-desventajas"><i class="fa fa-check"></i><b>8.1.2</b> Ventajas y desventajas</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="bagging-y-random-forest.html"><a href="bagging-y-random-forest.html"><i class="fa fa-check"></i><b>8.2</b> Bagging y Random Forest</a><ul>
<li class="chapter" data-level="8.2.1" data-path="bagging-y-random-forest.html"><a href="bagging-y-random-forest.html#en-r-1"><i class="fa fa-check"></i><b>8.2.1</b> En R</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="boosting.html"><a href="boosting.html"><i class="fa fa-check"></i><b>8.3</b> Boosting</a><ul>
<li class="chapter" data-level="8.3.1" data-path="boosting.html"><a href="boosting.html#optimizacion-de-parametros"><i class="fa fa-check"></i><b>8.3.1</b> Optimización de parámetros</a></li>
<li class="chapter" data-level="8.3.2" data-path="boosting.html"><a href="boosting.html#en-r-2"><i class="fa fa-check"></i><b>8.3.2</b> En R</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="explicacion-de-prediccion.html"><a href="explicacion-de-prediccion.html"><i class="fa fa-check"></i><b>8.4</b> Explicación de predicción</a><ul>
<li class="chapter" data-level="8.4.1" data-path="explicacion-de-prediccion.html"><a href="explicacion-de-prediccion.html#un-ejemplo-en-r"><i class="fa fa-check"></i><b>8.4.1</b> Un ejemplo en R</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>ANEXO</b></span></li>
<li class="chapter" data-level="A" data-path="sobre-in-training.html"><a href="sobre-in-training.html"><i class="fa fa-check"></i><b>A</b> Sobre in-training</a></li>
<li class="chapter" data-level="B" data-path="colaboradores.html"><a href="colaboradores.html"><i class="fa fa-check"></i><b>B</b> Colaboradores</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modelización en R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="practica-en-r" class="section level2">
<h2><span class="header-section-number">4.6</span> Práctica en R</h2>
<div class="info">
<p>Evaluaremos la calidad predictiva de dos modelos:</p>
<ul>
<li>Cuando la variable respuesta es binaria.</li>
<li>Cuando la variable respuesta es contínua.</li>
</ul>
</div>
<div id="preparacion-de-los-datos" class="section level3">
<h3><span class="header-section-number">4.6.1</span> Preparación de los datos</h3>
<blockquote>
<p>Definimos el Entorno de Trabajo</p>
</blockquote>
<p>El primer paso es crear una carpeta con nuestros modelos y resultados dentro de nuestro espacio de trabajo (proyecto).</p>
<ul>
<li>Obtenemos la ruta completa del directorio de trabajo<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a>.</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">myWD &lt;-<span class="st"> </span><span class="kw">getwd</span>() </code></pre>
<ul>
<li>Elegimos un nombre para nuestra carpeta con resultados</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">myWorkingFolderName &lt;-<span class="st"> &#39;ModelResults&#39;</span> </code></pre>
<ul>
<li>Creamos la carpeta donde guardaremos nuestros resultados y ficheros</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dir.create</span>( <span class="kw">paste0</span>(<span class="kw">getwd</span>(),<span class="st">&quot;/&quot;</span>,myWorkingFolderName))</code></pre>
<blockquote>
<p>Accedemos a los datos originales</p>
</blockquote>
<ul>
<li>Cargamos la librería <code>insuranceData</code> que contiene los datos que utilizaremos<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(insuranceData)) <span class="kw">install.packages</span>(<span class="st">&#39;insuranceData&#39;</span>)
<span class="kw">library</span>(insuranceData)</code></pre>
<ul>
<li>Para ver los contenidos de la librería <code>insuranceData</code> ejecutamos:</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="dt">package=</span><span class="st">&#39;insuranceData&#39;</span>)</code></pre>
<ul>
<li><p>Vemos que hay 10 datasets. Trabajaremos con el primero: <code>AutoBi</code> (<em>Automobile Bodily Injury Claims</em><a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a>).</p></li>
<li><p>Cargamos el conjunto de datos seleccionado: <strong>pérdidas en accidentes de coches</strong></p></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;AutoBi&quot;</span>)</code></pre>
<ul>
<li><p>Descripción de las 8 variables del conjunto de datos (<em>tabla</em>) ‘AutoBi’:</p>
<ol style="list-style-type: decimal">
<li><code>Casenum</code>. Identificador de la reclamación (esta variable no se utiliza en los modelos)</li>
<li><code>Attorney</code>. Indica si el reclamante está representado por un <strong>abogado</strong> (1= Sí, 2 = No)</li>
<li><code>Clmsex</code>. <strong>Sexo</strong> del reclamante (1 = Hombre, 2 = Mujer)</li>
<li><code>Marital</code>. <strong>Estado Civil</strong> del reclamante (1 = Casado, 2 = Soltero, 3 = Viudo, 4 = divorciado/separado)</li>
<li><code>Clminsur</code>. Indica si el conductor del vehículo del reclamante estaba o no <strong>asegurado</strong> (1 = Si, 2 = No, 3 = No aplica)</li>
<li><code>Seatbelt</code>. Si el reclamante llevaba o no un <strong>cinturón</strong> de seguridad en el asiento infantil (1 = Si, 2 = No, 3 = No Aplica)</li>
<li><code>Clmage</code>. <strong>Edad</strong> del reclamante.</li>
<li><code>Loss (*)</code>. La <strong>pérdida económica</strong> total del reclamante (en miles). Esta es la variable objetivo o dependiente del conjunto de datos.</li>
</ol></li>
<li><p>Revisamos el contenido de la tabla y el tipo de datos que contiene</p></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(AutoBi)</code></pre>
<pre><code>FALSE &#39;data.frame&#39;: 1340 obs. of  8 variables:
FALSE  $ CASENUM : int  5 13 66 71 96 97 120 136 152 155 ...
FALSE  $ ATTORNEY: int  1 2 2 1 2 1 1 1 2 2 ...
FALSE  $ CLMSEX  : int  1 2 1 1 1 2 1 2 2 1 ...
FALSE  $ MARITAL : int  NA 2 2 1 4 1 2 2 2 2 ...
FALSE  $ CLMINSUR: int  2 1 2 2 2 2 2 2 2 2 ...
FALSE  $ SEATBELT: int  1 1 1 2 1 1 1 1 1 1 ...
FALSE  $ CLMAGE  : int  50 28 5 32 30 35 19 34 61 NA ...
FALSE  $ LOSS    : num  34.94 10.892 0.33 11.037 0.138 ...</code></pre>
<ul>
<li>Exploramos el contenido con estadísticos descriptivos básicos</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(AutoBi)</code></pre>
<pre><code>FALSE     CASENUM         ATTORNEY         CLMSEX         MARITAL     
FALSE  Min.   :    5   Min.   :1.000   Min.   :1.000   Min.   :1.000  
FALSE  1st Qu.: 8579   1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000  
FALSE  Median :17453   Median :1.000   Median :2.000   Median :2.000  
FALSE  Mean   :17213   Mean   :1.489   Mean   :1.559   Mean   :1.593  
FALSE  3rd Qu.:25703   3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000  
FALSE  Max.   :34253   Max.   :2.000   Max.   :2.000   Max.   :4.000  
FALSE                                  NA&#39;s   :12      NA&#39;s   :16     
FALSE     CLMINSUR        SEATBELT         CLMAGE           LOSS         
FALSE  Min.   :1.000   Min.   :1.000   Min.   : 0.00   Min.   :   0.005  
FALSE  1st Qu.:2.000   1st Qu.:1.000   1st Qu.:19.00   1st Qu.:   0.640  
FALSE  Median :2.000   Median :1.000   Median :31.00   Median :   2.331  
FALSE  Mean   :1.908   Mean   :1.017   Mean   :32.53   Mean   :   5.954  
FALSE  3rd Qu.:2.000   3rd Qu.:1.000   3rd Qu.:43.00   3rd Qu.:   3.995  
FALSE  Max.   :2.000   Max.   :2.000   Max.   :95.00   Max.   :1067.697  
FALSE  NA&#39;s   :41      NA&#39;s   :48      NA&#39;s   :189</code></pre>
<ul>
<li>Para llamar directamente a las variables por sus nombres en la tabla AutoBi utilizamos el comando <code>attach</code></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attach</span>(AutoBi)</code></pre>
<blockquote>
<p>Exploramos la variable objetivo</p>
</blockquote>
<div class="info">
<p>LOSS es la <strong>variable objetivo</strong> una variable altamente asimétrica (con posibles outliers a la derecha o pérdida muy severa)<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a>.</p>
</div>
<ul>
<li>Analizamos la variable target</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(LOSS)</code></pre>
<pre><code>FALSE     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
FALSE    0.005    0.640    2.331    5.954    3.995 1067.697</code></pre>
<ul>
<li>Analizamos la distribución de la variable target</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(LOSS, <span class="dt">breaks=</span><span class="dv">300</span> , <span class="dt">probability =</span> T)
<span class="kw">lines</span>(<span class="kw">density</span>(LOSS), <span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">main=</span><span class="st">&quot;Loss distribution&quot;</span>)</code></pre>
<p><img src="02-Evaluation_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<ul>
<li>Utilizamos una medida <em>robusta</em> (depende de la mediana y del IQR<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a>) para segmentar los datos en dos clases:</li>
<li><code>1</code> si las pérdidas son atípicamente altas o</li>
<li><code>0</code> si no lo son.</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">lsup &lt;-<span class="st"> </span><span class="kw">median</span>(LOSS) <span class="op">+</span><span class="st"> </span><span class="fl">1.5</span><span class="op">*</span><span class="kw">IQR</span>(LOSS) <span class="co"># Criterio basado en estadisticos robustos</span>
<span class="kw">sum</span>(LOSS<span class="op">&gt;=</span>lsup) <span class="co"># 153 datos de perdidas atipicamente altas</span></code></pre>
<pre><code>FALSE [1] 153</code></pre>
<ul>
<li>(Opcional) Guardamos el gráfico del histograma de las <strong>pérdidas no severas</strong></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">  Path_to_graphics &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">getwd</span>(),<span class="st">&quot;/&quot;</span>,<span class="st">&quot;Graphics&quot;</span>)
  <span class="kw">dir.create</span>(Path_to_graphics)
  <span class="kw">png</span>(<span class="kw">paste0</span>(Path_to_graphics,<span class="st">&quot;/histograma.png&quot;</span>))
  <span class="kw">hist</span>(LOSS[LOSS<span class="op">&lt;</span>lsup], <span class="dt">breaks =</span> <span class="dv">100</span>, <span class="dt">probability =</span> T, <span class="dt">xlab=</span><span class="st">&quot;loss (pérdida en miles US $)&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Pérdida no severa&quot;</span>)
  <span class="kw">lines</span>(<span class="kw">density</span>(LOSS[LOSS<span class="op">&lt;</span>lsup]),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)
  <span class="kw">dev.off</span>()</code></pre>
<pre><code>FALSE png 
FALSE   2</code></pre>
<blockquote>
<p>Creamos el <em>dataset</em> de trabajo.</p>
</blockquote>
<ul>
<li>Creamos un dataset o tabla de trabajo eliminando la variable CASENUM (id) y filtrando por la variable LOSS y el valor lsup= 72.22587 (miles).</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">df_autobi &lt;-<span class="st"> </span>AutoBi[ , <span class="op">-</span><span class="kw">match</span>(<span class="st">&quot;CASENUM&quot;</span>, <span class="kw">colnames</span>(AutoBi)) ] </code></pre>
<ul>
<li><p>Fijamos los predictores categóricos como factores:</p>
<ul>
<li>Representado por un abogado: ‘1’ = representado por letrado y ‘2’ = no representado</li>
</ul></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">  df_autobi<span class="op">$</span>ATTORNEY &lt;-<span class="st"> </span><span class="kw">ordered</span>(df_autobi<span class="op">$</span>ATTORNEY, <span class="dt">levels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>) </code></pre>
<ul>
<li>Sexo: ‘1’ = hombre y ‘2’ = mujer</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">  df_autobi<span class="op">$</span>CLMSEX   &lt;-<span class="st"> </span><span class="kw">ordered</span>(df_autobi<span class="op">$</span>CLMSEX  , <span class="dt">levels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</code></pre>
<ul>
<li>Estado civil: ‘1’ = casado, ‘2’ = soltero, ‘3’ = viudo y ‘4’ = divorciado / separado</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">  df_autobi<span class="op">$</span>MARITAL  &lt;-<span class="st"> </span><span class="kw">ordered</span>(df_autobi<span class="op">$</span>MARITAL , <span class="dt">levels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</code></pre>
<ul>
<li>Vehículo asegurado: ‘1’ = vehículo estaba asegurado y ‘2’= no lo estaba</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">  df_autobi<span class="op">$</span>CLMINSUR &lt;-<span class="st"> </span><span class="kw">ordered</span>(df_autobi<span class="op">$</span>CLMINSUR, <span class="dt">levels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>) </code></pre>
<ul>
<li>Cinturón de seguridad: ‘1’ = llevaba cinturón abrochado y ‘2’ = no lo llevaba</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">  df_autobi<span class="op">$</span>SEATBELT &lt;-<span class="st"> </span><span class="kw">ordered</span>(df_autobi<span class="op">$</span>SEATBELT, <span class="dt">levels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</code></pre>
<ul>
<li>Pérdida: ‘1’= pérdida severa y ‘2’= pérdida no severa</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">df_autobi<span class="op">$</span>Y        &lt;-<span class="st"> </span><span class="kw">ifelse</span>(df_autobi<span class="op">$</span>LOSS<span class="op">&gt;=</span><span class="st"> </span>lsup,<span class="dv">1</span>,<span class="dv">0</span>)</code></pre>
<ul>
<li>Exploramos el <em>dataset</em> que acabamos de crear y verificamos la proporción de casos con pérdida severa (11.42%)</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(df_autobi)</code></pre>
<pre><code>FALSE  ATTORNEY  CLMSEX    MARITAL    CLMINSUR    SEATBELT        CLMAGE     
FALSE  1:685    1   :586   1   :624   1   : 120   1   :1270   Min.   : 0.00  
FALSE  2:655    2   :742   2   :650   2   :1179   2   :  22   1st Qu.:19.00  
FALSE           NA&#39;s: 12   3   : 15   NA&#39;s:  41   NA&#39;s:  48   Median :31.00  
FALSE                      4   : 35                           Mean   :32.53  
FALSE                      NA&#39;s: 16                           3rd Qu.:43.00  
FALSE                                                         Max.   :95.00  
FALSE                                                         NA&#39;s   :189    
FALSE       LOSS                Y         
FALSE  Min.   :   0.005   Min.   :0.0000  
FALSE  1st Qu.:   0.640   1st Qu.:0.0000  
FALSE  Median :   2.331   Median :0.0000  
FALSE  Mean   :   5.954   Mean   :0.1142  
FALSE  3rd Qu.:   3.995   3rd Qu.:0.0000  
FALSE  Max.   :1067.697   Max.   :1.0000  
FALSE </code></pre>
<ul>
<li>Exploramos la relación de la pérdida con los factores.</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">agg_loss_attorney &lt;-<span class="st"> </span><span class="kw">aggregate</span>(LOSS, <span class="dt">by =</span> <span class="kw">list</span>(ATTORNEY) , <span class="dt">FUN=</span> mean , <span class="dt">na.rm=</span><span class="ot">TRUE</span>)
  <span class="kw">dimnames</span>(agg_loss_attorney)[[<span class="dv">1</span>]] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;REPRESENTED&quot;</span>,<span class="st">&quot;NOT REPRESENTED&quot;</span>) ; <span class="kw">dimnames</span>(agg_loss_attorney)[[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ATTORNEY&quot;</span>,<span class="st">&quot;LOSS&quot;</span>)
  
  agg_loss_clmsex   &lt;-<span class="st"> </span><span class="kw">aggregate</span>(LOSS, <span class="dt">by =</span> <span class="kw">list</span>(CLMSEX)  , <span class="dt">FUN=</span> mean , <span class="dt">na.rm=</span><span class="ot">TRUE</span>)
  <span class="kw">dimnames</span>(agg_loss_clmsex)[[<span class="dv">1</span>]]   &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;MALE&quot;</span>,<span class="st">&quot;FEMALE&quot;</span>)  ; <span class="kw">dimnames</span>(agg_loss_clmsex)[[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;CLMSEX&quot;</span>,<span class="st">&quot;LOSS&quot;</span>)
  
  agg_loss_marital  &lt;-<span class="st"> </span><span class="kw">aggregate</span>(LOSS, <span class="dt">by =</span> <span class="kw">list</span>(MARITAL) , <span class="dt">FUN=</span> mean , <span class="dt">na.rm=</span><span class="ot">TRUE</span>)
  <span class="kw">dimnames</span>(agg_loss_marital)[[<span class="dv">1</span>]]  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;MARRIED&quot;</span>,<span class="st">&quot;SINGLE&quot;</span>,<span class="st">&quot;WIDOW&quot;</span>,<span class="st">&quot;DIVORCED&quot;</span>) ; <span class="kw">dimnames</span>(agg_loss_marital)[[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;MARITAL&quot;</span>,<span class="st">&quot;LOSS&quot;</span>)
  
  agg_loss_clminsur &lt;-<span class="st"> </span><span class="kw">aggregate</span>(LOSS, <span class="dt">by =</span> <span class="kw">list</span>(CLMINSUR) , <span class="dt">FUN=</span> mean , <span class="dt">na.rm=</span><span class="ot">TRUE</span>)
  <span class="kw">dimnames</span>(agg_loss_clminsur)[[<span class="dv">1</span>]] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;INSURED&quot;</span>,<span class="st">&quot;NOT INSURED&quot;</span>) ; <span class="kw">dimnames</span>(agg_loss_clminsur)[[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;CLMINSUR&quot;</span>,<span class="st">&quot;LOSS&quot;</span>)
  
  agg_loss_seatbelt &lt;-<span class="st"> </span><span class="kw">aggregate</span>(LOSS, <span class="dt">by =</span> <span class="kw">list</span>(SEATBELT) , <span class="dt">FUN=</span> mean , <span class="dt">na.rm=</span><span class="ot">TRUE</span>)
  <span class="kw">dimnames</span>(agg_loss_seatbelt)[[<span class="dv">1</span>]] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;SEATBELT&quot;</span>,<span class="st">&quot;NOT SEATBELT&quot;</span>) ; <span class="kw">dimnames</span>(agg_loss_seatbelt)[[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;SEATBELT&quot;</span>,<span class="st">&quot;LOSS&quot;</span>)</code></pre>
<blockquote>
<p>Creamos los sets <em>train</em> y <em>test</em></p>
</blockquote>
<ul>
<li>Aleatorizamos los datos y separamos el set de datos en <em>train</em> y <em>test</em>:</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">N=<span class="kw">nrow</span>(df_autobi)</code></pre>
<ul>
<li>Es recomendable fijar una semilla (seed) para los algoritmos de aleatorización internos de R</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(caret)) <span class="kw">install.packages</span>(<span class="st">&#39;caret&#39;</span>)
<span class="kw">library</span>(caret)  
<span class="kw">set.seed</span>(<span class="dv">123456</span>)
inTrain  &lt;-<span class="st"> </span><span class="kw">createDataPartition</span>(df_autobi<span class="op">$</span>Y, <span class="dt">times =</span> <span class="dv">1</span>, <span class="dt">p =</span> <span class="fl">0.7</span>, <span class="dt">list =</span> <span class="ot">TRUE</span>)
dt_train &lt;-<span class="st"> </span>df_autobi[inTrain[[<span class="dv">1</span>]],]  <span class="co"># 938 casos</span>
dt_test  &lt;-<span class="st"> </span>df_autobi[<span class="op">-</span>inTrain[[<span class="dv">1</span>]],] <span class="co"># 402 casos</span>
  
<span class="kw">nrow</span>(dt_train)</code></pre>
<pre><code>FALSE [1] 938</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(dt_train)</code></pre>
<pre><code>FALSE  ATTORNEY  CLMSEX    MARITAL    CLMINSUR   SEATBELT       CLMAGE     
FALSE  1:471    1   :406   1   :439   1   : 77   1   :885   Min.   : 0.00  
FALSE  2:467    2   :523   2   :455   2   :833   2   : 17   1st Qu.:20.00  
FALSE           NA&#39;s:  9   3   : 10   NA&#39;s: 28   NA&#39;s: 36   Median :32.00  
FALSE                      4   : 25                         Mean   :33.06  
FALSE                      NA&#39;s:  9                         3rd Qu.:43.00  
FALSE                                                       Max.   :95.00  
FALSE                                                       NA&#39;s   :134    
FALSE       LOSS                Y         
FALSE  Min.   :  0.0050   Min.   :0.0000  
FALSE  1st Qu.:  0.7123   1st Qu.:0.0000  
FALSE  Median :  2.3645   Median :0.0000  
FALSE  Mean   :  5.4656   Mean   :0.1141  
FALSE  3rd Qu.:  4.0263   3rd Qu.:0.0000  
FALSE  Max.   :273.6040   Max.   :1.0000  
FALSE </code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nrow</span>(dt_test)</code></pre>
<pre><code>FALSE [1] 402</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(dt_test)</code></pre>
<pre><code>FALSE  ATTORNEY  CLMSEX    MARITAL    CLMINSUR   SEATBELT       CLMAGE     
FALSE  1:214    1   :180   1   :185   1   : 43   1   :385   Min.   : 0.00  
FALSE  2:188    2   :219   2   :195   2   :346   2   :  5   1st Qu.:19.00  
FALSE           NA&#39;s:  3   3   :  5   NA&#39;s: 13   NA&#39;s: 12   Median :29.00  
FALSE                      4   : 10                         Mean   :31.31  
FALSE                      NA&#39;s:  7                         3rd Qu.:42.00  
FALSE                                                       Max.   :78.00  
FALSE                                                       NA&#39;s   :55     
FALSE       LOSS                 Y         
FALSE  Min.   :   0.0050   Min.   :0.0000  
FALSE  1st Qu.:   0.5175   1st Qu.:0.0000  
FALSE  Median :   2.1645   Median :0.0000  
FALSE  Mean   :   7.0917   Mean   :0.1144  
FALSE  3rd Qu.:   3.7782   3rd Qu.:0.0000  
FALSE  Max.   :1067.6970   Max.   :1.0000  
FALSE </code></pre>
<p>Comprobamos si se que los conjuntos train y test se han formado correctamente</p>
<pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">length</span>(<span class="kw">intersect</span>(inTrain, <span class="kw">setdiff</span>(<span class="dv">1</span><span class="op">:</span>N,inTrain)))</code></pre>
<pre><code>FALSE [1] 0</code></pre>
</div>
<div id="clasificacion-1" class="section level3">
<h3><span class="header-section-number">4.6.2</span> Clasificación</h3>
<div class="info">
<p>Vamos a construir un modelo para identificar los casos con pérdidas severas.</p>
</div>
<ul>
<li>El primer ejemplo lo hacemos con <em>Random Forest</em></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(randomForest)) <span class="kw">install.packages</span>(<span class="st">&#39;randomForest&#39;</span>)
<span class="kw">library</span>(randomForest)</code></pre>
<ul>
<li>Creamos un objeto de clase ‘formula’ y se lo pasamos como argumento a la función <code>randomForest</code><a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">123456</span>)
fmla.rf1 &lt;-<span class="st"> </span><span class="kw">as.formula</span>(<span class="kw">paste0</span>(<span class="st">&quot;Y&quot;</span>,<span class="st">&quot; ~&quot;</span>,<span class="kw">paste0</span>(<span class="kw">colnames</span>(df_autobi[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">8</span>)]),<span class="dt">collapse =</span> <span class="st">&quot;+&quot;</span>),<span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>))
rf1 &lt;-<span class="st"> </span><span class="kw">randomForest</span>( fmla.rf1,
                       <span class="dt">data =</span>dt_train,
                       <span class="dt">ntree =</span> <span class="dv">5000</span>, <span class="co"># se ejecuta muy rapido, podemos utilizar ntree &gt; = 2500</span>
                       <span class="dt">replace =</span><span class="ot">TRUE</span>,
                       <span class="dt">mtry=</span><span class="dv">4</span>,
                       <span class="dt">maxnodes =</span><span class="dv">50</span>,
                       <span class="dt">importance =</span> <span class="ot">TRUE</span>,
                       <span class="dt">proximity =</span>   <span class="ot">TRUE</span>,
                       <span class="dt">keep.forest =</span> <span class="ot">TRUE</span>,
                       <span class="dt">na.action=</span>na.omit)</code></pre>
<ul>
<li>Exploramos el objeto con los resutados</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">rf1</code></pre>
<pre><code>FALSE 
FALSE Call:
FALSE  randomForest(formula = fmla.rf1, data = dt_train, ntree = 5000,      replace = TRUE, mtry = 4, maxnodes = 50, importance = TRUE,      proximity = TRUE, keep.forest = TRUE, na.action = na.omit) 
FALSE                Type of random forest: regression
FALSE                      Number of trees: 5000
FALSE No. of variables tried at each split: 4
FALSE 
FALSE           Mean of squared residuals: 0.1009875
FALSE                     % Var explained: 4.3</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(rf1)</code></pre>
<pre><code>FALSE                 Length Class  Mode     
FALSE call                11 -none- call     
FALSE type                 1 -none- character
FALSE predicted          759 -none- numeric  
FALSE mse               5000 -none- numeric  
FALSE rsq               5000 -none- numeric  
FALSE oob.times          759 -none- numeric  
FALSE importance          12 -none- numeric  
FALSE importanceSD         6 -none- numeric  
FALSE localImportance      0 -none- NULL     
FALSE proximity       576081 -none- numeric  
FALSE ntree                1 -none- numeric  
FALSE mtry                 1 -none- numeric  
FALSE forest              11 -none- list     
FALSE coefs                0 -none- NULL     
FALSE y                  759 -none- numeric  
FALSE test                 0 -none- NULL     
FALSE inbag                0 -none- NULL     
FALSE terms                3 terms  call     
FALSE na.action          179 omit   numeric</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(rf1)</code></pre>
<pre><code>FALSE List of 19
FALSE  $ call           : language randomForest(formula = fmla.rf1, data = dt_train, ntree = 5000, replace = TRUE,      mtry = 4, maxnodes = 50, imp| __truncated__ ...
FALSE  $ type           : chr &quot;regression&quot;
FALSE  $ predicted      : Named num [1:759] 0.00767 0.000161 0.629748 0.008208 0.022047 ...
FALSE   ..- attr(*, &quot;names&quot;)= chr [1:759] &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot; ...
FALSE   ..- attr(*, &quot;na.action&quot;)= &#39;omit&#39; Named int [1:179] 1 9 19 25 27 40 43 46 50 51 ...
FALSE   .. ..- attr(*, &quot;names&quot;)= chr [1:179] &quot;1&quot; &quot;10&quot; &quot;24&quot; &quot;30&quot; ...
FALSE  $ mse            : num [1:5000] 0.102 0.129 0.121 0.115 0.113 ...
FALSE  $ rsq            : num [1:5000] 0.0302 -0.2272 -0.1473 -0.0907 -0.071 ...
FALSE  $ oob.times      : int [1:759] 1804 1942 1844 1864 1855 1780 1837 1782 1847 1807 ...
FALSE  $ importance     : num [1:6, 1:2] 0.017697 -0.001602 0.004106 0.000933 0.0009 ...
FALSE   ..- attr(*, &quot;dimnames&quot;)=List of 2
FALSE   .. ..$ : chr [1:6] &quot;ATTORNEY&quot; &quot;CLMSEX&quot; &quot;MARITAL&quot; &quot;CLMINSUR&quot; ...
FALSE   .. ..$ : chr [1:2] &quot;%IncMSE&quot; &quot;IncNodePurity&quot;
FALSE  $ importanceSD   : Named num [1:6] 1.50e-04 8.42e-05 1.54e-04 8.18e-05 5.65e-05 ...
FALSE   ..- attr(*, &quot;names&quot;)= chr [1:6] &quot;ATTORNEY&quot; &quot;CLMSEX&quot; &quot;MARITAL&quot; &quot;CLMINSUR&quot; ...
FALSE  $ localImportance: NULL
FALSE  $ proximity      : num [1:759, 1:759] 1 0.179 0 0.318 0 ...
FALSE   ..- attr(*, &quot;dimnames&quot;)=List of 2
FALSE   .. ..$ : chr [1:759] &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot; ...
FALSE   .. ..$ : chr [1:759] &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot; ...
FALSE  $ ntree          : num 5000
FALSE  $ mtry           : num 4
FALSE  $ forest         :List of 11
FALSE   ..$ ndbigtree    : int [1:5000] 99 99 99 99 99 99 99 99 99 99 ...
FALSE   ..$ nodestatus   : int [1:99, 1:5000] -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 ...
FALSE   ..$ leftDaughter : int [1:99, 1:5000] 2 4 6 8 10 12 14 16 18 20 ...
FALSE   ..$ rightDaughter: int [1:99, 1:5000] 3 5 7 9 11 13 15 17 19 21 ...
FALSE   ..$ nodepred     : num [1:99, 1:5000] 0.1265 0.2198 0.0363 0.0115 0.2832 ...
FALSE   ..$ bestvar      : int [1:99, 1:5000] 1 6 4 6 5 6 6 6 6 3 ...
FALSE   ..$ xbestsplit   : num [1:99, 1:5000] 1.5 20.5 1.5 15.5 1.5 27.5 34.5 0 16.5 3.5 ...
FALSE   ..$ ncat         : Named int [1:6] 1 1 1 1 1 1
FALSE   .. ..- attr(*, &quot;names&quot;)= chr [1:6] &quot;ATTORNEY&quot; &quot;CLMSEX&quot; &quot;MARITAL&quot; &quot;CLMINSUR&quot; ...
FALSE   ..$ nrnodes      : int 99
FALSE   ..$ ntree        : num 5000
FALSE   ..$ xlevels      :List of 6
FALSE   .. ..$ ATTORNEY: num 0
FALSE   .. ..$ CLMSEX  : num 0
FALSE   .. ..$ MARITAL : num 0
FALSE   .. ..$ CLMINSUR: num 0
FALSE   .. ..$ SEATBELT: num 0
FALSE   .. ..$ CLMAGE  : num 0
FALSE  $ coefs          : NULL
FALSE  $ y              : Named num [1:759] 1 0 1 0 0 0 0 0 0 1 ...
FALSE   ..- attr(*, &quot;na.action&quot;)= &#39;omit&#39; Named int [1:179] 1 9 19 25 27 40 43 46 50 51 ...
FALSE   .. ..- attr(*, &quot;names&quot;)= chr [1:179] &quot;1&quot; &quot;10&quot; &quot;24&quot; &quot;30&quot; ...
FALSE   ..- attr(*, &quot;names&quot;)= chr [1:759] &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot; ...
FALSE  $ test           : NULL
FALSE  $ inbag          : NULL
FALSE  $ terms          :Classes &#39;terms&#39;, &#39;formula&#39;  language Y ~ ATTORNEY + CLMSEX + MARITAL + CLMINSUR + SEATBELT + CLMAGE
FALSE   .. ..- attr(*, &quot;variables&quot;)= language list(Y, ATTORNEY, CLMSEX, MARITAL, CLMINSUR, SEATBELT, CLMAGE)
FALSE   .. ..- attr(*, &quot;factors&quot;)= int [1:7, 1:6] 0 1 0 0 0 0 0 0 0 1 ...
FALSE   .. .. ..- attr(*, &quot;dimnames&quot;)=List of 2
FALSE   .. .. .. ..$ : chr [1:7] &quot;Y&quot; &quot;ATTORNEY&quot; &quot;CLMSEX&quot; &quot;MARITAL&quot; ...
FALSE   .. .. .. ..$ : chr [1:6] &quot;ATTORNEY&quot; &quot;CLMSEX&quot; &quot;MARITAL&quot; &quot;CLMINSUR&quot; ...
FALSE   .. ..- attr(*, &quot;term.labels&quot;)= chr [1:6] &quot;ATTORNEY&quot; &quot;CLMSEX&quot; &quot;MARITAL&quot; &quot;CLMINSUR&quot; ...
FALSE   .. ..- attr(*, &quot;order&quot;)= int [1:6] 1 1 1 1 1 1
FALSE   .. ..- attr(*, &quot;intercept&quot;)= num 0
FALSE   .. ..- attr(*, &quot;response&quot;)= int 1
FALSE   .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_GlobalEnv&gt; 
FALSE   .. ..- attr(*, &quot;predvars&quot;)= language list(Y, ATTORNEY, CLMSEX, MARITAL, CLMINSUR, SEATBELT, CLMAGE)
FALSE   .. ..- attr(*, &quot;dataClasses&quot;)= Named chr [1:7] &quot;numeric&quot; &quot;ordered&quot; &quot;ordered&quot; &quot;ordered&quot; ...
FALSE   .. .. ..- attr(*, &quot;names&quot;)= chr [1:7] &quot;Y&quot; &quot;ATTORNEY&quot; &quot;CLMSEX&quot; &quot;MARITAL&quot; ...
FALSE  $ na.action      : &#39;omit&#39; Named int [1:179] 1 9 19 25 27 40 43 46 50 51 ...
FALSE   ..- attr(*, &quot;names&quot;)= chr [1:179] &quot;1&quot; &quot;10&quot; &quot;24&quot; &quot;30&quot; ...
FALSE  - attr(*, &quot;class&quot;)= chr [1:2] &quot;randomForest.formula&quot; &quot;randomForest&quot;</code></pre>
<blockquote>
<p>Gráfico de la importancia relativa de los predictores</p>
</blockquote>
<pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">varImpPlot</span>(rf1,<span class="dt">sort =</span> T,<span class="dt">main =</span> <span class="st">&quot;Variable Importance&quot;</span>)</code></pre>
<p><img src="02-Evaluation_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<blockquote>
<p>Gráfico del Error vs número de árboles</p>
</blockquote>
<pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">plot</span>(rf1, <span class="dt">main=</span><span class="st">&quot;Error de clasificación vs núero de  árboles&quot;</span>) </code></pre>
<p><img src="02-Evaluation_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<blockquote>
<p>Gráfico de la probabilidad condicional: <span class="math inline">\(P(Y=1|X_1 = ATTORNEY,\ldots,X_6=SEATBELT)\)</span></p>
</blockquote>
<pre class="sourceCode r"><code class="sourceCode r">  rf1.prediction &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">predict</span>(rf1, <span class="dt">newdata =</span> dt_train))
  <span class="kw">summary</span>(rf1.prediction)</code></pre>
<pre><code>##  predict(rf1, newdata = dt_train)
##  Min.   :0.00005                 
##  1st Qu.:0.00599                 
##  Median :0.03651                 
##  Mean   :0.11984                 
##  3rd Qu.:0.21024                 
##  Max.   :0.77138                 
##  NA&#39;s   :179</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">  dt_train<span class="op">$</span>pred_rf1 &lt;-<span class="st"> </span>rf1.prediction<span class="op">$</span><span class="st">`</span><span class="dt">predict(rf1, newdata = dt_train)</span><span class="st">`</span> 
  <span class="kw">head</span>(dt_train,<span class="dv">3</span>)</code></pre>
<pre><code>##   ATTORNEY CLMSEX MARITAL CLMINSUR SEATBELT CLMAGE   LOSS Y     pred_rf1
## 1        1      1    &lt;NA&gt;        2        1     50 34.940 1           NA
## 2        2      2       2        1        1     28 10.892 1 0.3807199932
## 3        2      1       2        2        1      5  0.330 0 0.0001324938</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">tail</span>(dt_train,<span class="dv">3</span>)</code></pre>
<pre><code>##      ATTORNEY CLMSEX MARITAL CLMINSUR SEATBELT CLMAGE  LOSS Y    pred_rf1
## 1335        2      2       2        2        1     26 0.161 0 0.001142849
## 1338        2      2       1        2        1     39 0.099 0 0.012354460
## 1340        2      2       2        2        1     30 0.688 0 0.002329733</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">summary</span>(dt_train)</code></pre>
<pre><code>##  ATTORNEY  CLMSEX    MARITAL    CLMINSUR   SEATBELT       CLMAGE     
##  1:471    1   :406   1   :439   1   : 77   1   :885   Min.   : 0.00  
##  2:467    2   :523   2   :455   2   :833   2   : 17   1st Qu.:20.00  
##           NA&#39;s:  9   3   : 10   NA&#39;s: 28   NA&#39;s: 36   Median :32.00  
##                      4   : 25                         Mean   :33.06  
##                      NA&#39;s:  9                         3rd Qu.:43.00  
##                                                       Max.   :95.00  
##                                                       NA&#39;s   :134    
##       LOSS                Y             pred_rf1      
##  Min.   :  0.0050   Min.   :0.0000   Min.   :0.00005  
##  1st Qu.:  0.7123   1st Qu.:0.0000   1st Qu.:0.00599  
##  Median :  2.3645   Median :0.0000   Median :0.03651  
##  Mean   :  5.4656   Mean   :0.1141   Mean   :0.11984  
##  3rd Qu.:  4.0263   3rd Qu.:0.0000   3rd Qu.:0.21024  
##  Max.   :273.6040   Max.   :1.0000   Max.   :0.77138  
##                                      NA&#39;s   :179</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">plot</span>(<span class="kw">density</span>(dt_train<span class="op">$</span>pred_rf1[<span class="op">!</span><span class="kw">is.na</span>(dt_train<span class="op">$</span>pred_rf1)]), <span class="dt">col=</span><span class="st">&quot;red&quot;</span> , <span class="dt">xlab=</span><span class="st">&quot;Probabilidad&quot;</span> , <span class="dt">main=</span><span class="st">&quot;Función de densidad estimada&quot;</span>)</code></pre>
<p><img src="02-Evaluation_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<ul>
<li><p>Vemos que hay (claramente) dos concentraciones (clases) de probabilidades de pérdida, una concentración en torno a la probabilidad de pérdida no severa (<span class="math inline">\(Y=0\)</span>) y otra para la pérdida severa (<span class="math inline">\(Y=1\)</span>).</p></li>
<li><p>Esto no lleva a la elección del <strong>punto de corte óptimo</strong> para obtener una regla de clasificación, es decir, un criterio para <span class="math inline">\(Y_{predicted}=1\)</span> (pérdida severa), o bien, para <span class="math inline">\(Y_{predicted}=0\)</span> (pérdida no severa). Una alternativa es el criterio de la <strong>Distancia de Kolmogorov-Smirnov</strong> (KS).</p></li>
</ul>
<blockquote>
<p>Métricas de evaluación del poder de clasificación</p>
</blockquote>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(ModelMetrics)) <span class="kw">install.packages</span>(<span class="st">&#39;ModelMetrics&#39;</span>)
<span class="kw">library</span>(ModelMetrics)
<span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(ROCR)) <span class="kw">install.packages</span>(<span class="st">&#39;ROCR&#39;</span>)
<span class="kw">library</span>(ROCR)
<span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(binaryLogic)) <span class="kw">install.packages</span>(<span class="st">&#39;binaryLogic&#39;</span>)
<span class="kw">library</span>(binaryLogic)</code></pre>
<ul>
<li>Con el train creamos un objeto de tipo ‘prediction’<a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">  rf1.pred &lt;-<span class="st"> </span><span class="kw">prediction</span>(<span class="kw">as.numeric</span>(rf1<span class="op">$</span>predicted),<span class="kw">as.numeric</span>(rf1<span class="op">$</span>y)) </code></pre>
<ul>
<li>Calculamos la Curva de ROC con la función ‘performance’ sobre el objeto ‘rf1’</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">  rf1.perf &lt;-<span class="st"> </span><span class="kw">performance</span>(rf1.pred,<span class="st">&quot;tpr&quot;</span>,<span class="st">&quot;fpr&quot;</span>) 
 <span class="co">## &quot;fpr&quot; = False positive rate. P(Yhat = + | Y = -). Estimated as: FP/N.</span>
 <span class="co">## &quot;tpr&quot; = True positive rate. P(Yhat = + | Y = +). Estimated as: TP/P.</span>
 <span class="kw">plot</span>(rf1.perf)</code></pre>
<p><img src="02-Evaluation_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<blockquote>
<p>Elección del punto de corte: Criterio de la distancia de KS</p>
</blockquote>
<ul>
<li>La distancia KS se calcula como: KS = abs(<a href="mailto:rf1.perf@y.values" class="email">rf1.perf@y.values</a>[[1]]-<a href="mailto:rf1.perf@x.values" class="email">rf1.perf@x.values</a>[[1]])</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">rf1.perf<span class="op">@</span>alpha.values[[<span class="dv">1</span>]][rf1.perf<span class="op">@</span>alpha.values[[<span class="dv">1</span>]]<span class="op">==</span><span class="ot">Inf</span>] &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">max</span>(rf1.perf<span class="op">@</span>alpha.values[[<span class="dv">1</span>]][rf1.perf<span class="op">@</span>alpha.values[[<span class="dv">1</span>]]<span class="op">!=</span><span class="ot">Inf</span>]),<span class="dv">2</span>)
KS.matrix=<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">abs</span>(rf1.perf<span class="op">@</span>y.values[[<span class="dv">1</span>]]<span class="op">-</span>rf1.perf<span class="op">@</span>x.values[[<span class="dv">1</span>]]), rf1.perf<span class="op">@</span>alpha.values[[<span class="dv">1</span>]])</code></pre>
<ul>
<li>Resumiendo</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colnames</span>(KS.matrix) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;KS-distance&quot;</span>,<span class="st">&quot;cut-point&quot;</span>)
<span class="kw">head</span>(KS.matrix)</code></pre>
<pre><code>##      KS-distance cut-point
## [1,] 0.000000000 0.7800000
## [2,] 0.001497006 0.7809184
## [3,] 0.002994012 0.7353170
## [4,] 0.004491018 0.6577091
## [5,] 0.005988024 0.6481896
## [6,] 0.005000987 0.6297476</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">ind.ks  &lt;-<span class="st"> </span><span class="kw">sort</span>( KS.matrix[,<span class="dv">1</span>] , <span class="dt">index.return=</span><span class="ot">TRUE</span> )<span class="op">$</span>ix[<span class="kw">nrow</span>(KS.matrix)] </code></pre>
<ul>
<li>El punto de corte óptimo de KS:</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">  rf1.KScutoff &lt;-<span class="st"> </span>KS.matrix[ind.ks,<span class="dv">2</span>] <span class="co"># := f(rf1.KS1)</span>
  rf1.KScutoff</code></pre>
<pre><code>##  cut-point 
## 0.06415734</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 0.04 - 0.05 </span></code></pre>
<blockquote>
<p>Gráfico de la Curva ROC y su métrica: Área bajo la curva ROC (AUC)</p>
</blockquote>
<ul>
<li>Cálculo de AUC mediante la función ‘performance’</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">rf1.auc1 &lt;-<span class="st"> </span><span class="kw">performance</span>(rf1.pred,<span class="st">&quot;auc&quot;</span>)<span class="op">@</span>y.values[[<span class="dv">1</span>]]
rf1.auc1</code></pre>
<pre><code>FALSE [1] 0.7424327</code></pre>
<p>-Cálculo de la curva ROC junto con la métrica AUC</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#win.graph()</span>
<span class="kw">plot</span>( rf1.perf , <span class="dt">col=</span><span class="st">&#39;red&#39;</span>  , <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;Tasa de falsos positivos&quot;</span> , <span class="dt">ylab=</span><span class="st">&quot;Tasa de verdaderos positivos&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Curva ROC con Random Forest&quot;</span>)
<span class="kw">abline</span>( <span class="dv">0</span> , <span class="dv">1</span>  , <span class="dt">col=</span><span class="st">&quot;blue&quot;</span> , <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">lty=</span><span class="dv">2</span>)
<span class="kw">abline</span>( <span class="dv">0</span> , <span class="dv">0</span> , <span class="dv">1</span> , <span class="dt">col=</span><span class="st">&quot;gray40&quot;</span>   , <span class="dt">lty=</span><span class="dv">3</span>)
<span class="kw">legend</span>( <span class="fl">0.4</span>, <span class="fl">0.15</span> , <span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;AUC (Random Forest)=&quot;</span>,<span class="kw">round</span>(rf1.auc1,<span class="dv">4</span>)),<span class="st">&quot;AUC (clasificacion al azar)=0.50&quot;</span>),<span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">lwd=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>) ,<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>)</code></pre>
<p><img src="02-Evaluation_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<ul>
<li>Se realizar el mismo gráfico de la curva ROC utilizando la librería <code>ggplot2</code>. Para ello guardamos los datos en un <code>data.frame</code></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;ggplot2&quot;</span>)
df.perf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span>rf1.perf<span class="op">@</span>x.values[[<span class="dv">1</span>]],<span class="dt">y=</span>rf1.perf<span class="op">@</span>y.values[[<span class="dv">1</span>]])</code></pre>
<ul>
<li>Construcción del objeto gráfico con <code>ggplot2</code></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#win.graph()</span>
p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df.perf,<span class="kw">aes</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_path</span>(<span class="dt">size=</span><span class="dv">1</span>, <span class="dt">colour=</span><span class="st">&quot;red&quot;</span>)
p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Curva ROC modelo Random Forest&quot;</span>)
p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">theme_update</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>))
p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="dv">0</span>,<span class="dt">y=</span><span class="dv">0</span>,<span class="dt">xend=</span><span class="dv">1</span>,<span class="dt">yend=</span><span class="dv">1</span>),<span class="dt">colour=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">linetype=</span> <span class="dv">2</span>)
p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="fl">0.75</span> , <span class="dt">y=</span><span class="fl">0.3</span> , <span class="dt">label=</span><span class="kw">paste</span>(<span class="dt">sep =</span><span class="st">&quot;&quot;</span>,<span class="st">&quot;AUC (Random Forest) ) = &quot;</span>,<span class="kw">round</span>(rf1.auc1,<span class="dv">4</span>) )),<span class="dt">colour=</span><span class="st">&quot;black&quot;</span>,<span class="dt">size=</span><span class="dv">4</span>)
p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="fl">0.75</span> , <span class="dt">y=</span><span class="fl">0.25</span> , <span class="dt">label=</span><span class="kw">paste</span>(<span class="dt">sep =</span><span class="st">&quot;&quot;</span>,<span class="st">&quot;AUC (Coin toss) = &quot;</span>,<span class="kw">round</span>(<span class="fl">0.50</span>,<span class="dv">4</span>) )),<span class="dt">colour=</span><span class="st">&quot;black&quot;</span>,<span class="dt">size=</span><span class="dv">4</span>)
p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">name=</span> <span class="st">&quot;Tasa de falsos positivos&quot;</span>)
p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">name=</span> <span class="st">&quot;Tasa de verdaderos positivos&quot;</span>)
p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(
  <span class="dt">plot.title   =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">2</span>),
  <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
  <span class="dt">axis.text.y  =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
  <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>,<span class="dt">face =</span> <span class="st">&quot;italic&quot;</span>),
  <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>,<span class="dt">face =</span> <span class="st">&quot;italic&quot;</span>,<span class="dt">angle=</span><span class="dv">90</span>),
  <span class="dt">legend.title     =</span> <span class="kw">element_blank</span>(), 
  <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey&quot;</span>),
  <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(), 
  <span class="dt">panel.grid.major =</span> <span class="kw">element_line</span>(<span class="dt">colour=</span><span class="st">&#39;white&#39;</span>),
  <span class="dt">plot.background  =</span> <span class="kw">element_blank</span>()
)

p</code></pre>
<p><img src="02-Evaluation_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<blockquote>
<p>Métricas de evaluación del poder predictivo</p>
</blockquote>
<ul>
<li>Calculamos la predicción en el <em>test</em> y evaluamos el poder de clasificación del modelo</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">rf1.pred_test     &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">predict</span>( rf1, <span class="dt">newdata =</span> dt_test))
dt_test<span class="op">$</span>pred_rf1  &lt;-<span class="st"> </span>rf1.pred_test<span class="op">$</span><span class="st">`</span><span class="dt">predict(rf1, newdata = dt_test)</span><span class="st">`</span> </code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(dt_test,<span class="dv">3</span>)</code></pre>
<pre><code>##    ATTORNEY CLMSEX MARITAL CLMINSUR SEATBELT CLMAGE   LOSS Y  pred_rf1
## 6         1      2       1        2        1     35  0.309 0 0.2279703
## 12        1      1       1        2        1     42 29.620 1 0.2159590
## 18        1      1       1        2        1     58  0.758 0 0.2047155</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tail</span>(dt_test,<span class="dv">3</span>)</code></pre>
<pre><code>##      ATTORNEY CLMSEX MARITAL CLMINSUR SEATBELT CLMAGE  LOSS Y    pred_rf1
## 1336        2      1       2        2        1     NA 0.576 0          NA
## 1337        1      2       1        2        1     46 3.705 0 0.349066396
## 1339        1      2       2        1        1     18 3.277 0 0.004032191</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(dt_test)</code></pre>
<pre><code>##  ATTORNEY  CLMSEX    MARITAL    CLMINSUR   SEATBELT       CLMAGE     
##  1:214    1   :180   1   :185   1   : 43   1   :385   Min.   : 0.00  
##  2:188    2   :219   2   :195   2   :346   2   :  5   1st Qu.:19.00  
##           NA&#39;s:  3   3   :  5   NA&#39;s: 13   NA&#39;s: 12   Median :29.00  
##                      4   : 10                         Mean   :31.31  
##                      NA&#39;s:  7                         3rd Qu.:42.00  
##                                                       Max.   :78.00  
##                                                       NA&#39;s   :55     
##       LOSS                 Y             pred_rf1      
##  Min.   :   0.0050   Min.   :0.0000   Min.   :0.00005  
##  1st Qu.:   0.5175   1st Qu.:0.0000   1st Qu.:0.00797  
##  Median :   2.1645   Median :0.0000   Median :0.03794  
##  Mean   :   7.0917   Mean   :0.1144   Mean   :0.12531  
##  3rd Qu.:   3.7782   3rd Qu.:0.0000   3rd Qu.:0.21666  
##  Max.   :1067.6970   Max.   :1.0000   Max.   :0.75036  
##                                       NA&#39;s   :70</code></pre>
<ul>
<li>Con el <em>test</em> creamos un objeto de tipo ‘prediction’ y calculamos la curva ROC</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">dt_test.pred  &lt;-<span class="st"> </span><span class="kw">prediction</span>(<span class="kw">as.numeric</span>(rf1.pred_test<span class="op">$</span><span class="st">`</span><span class="dt">predict(rf1, newdata = dt_test)</span><span class="st">`</span>),dt_test<span class="op">$</span>Y) 
dt_test.perf  &lt;-<span class="st"> </span><span class="kw">performance</span>(dt_test.pred,<span class="st">&quot;tpr&quot;</span>,<span class="st">&quot;fpr&quot;</span>) </code></pre>
<ul>
<li>Evaluación del poder de clasificación del modelo RF1 vía curva ROC</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">rf1.test.auc &lt;-<span class="st"> </span><span class="kw">performance</span>(dt_test.pred ,<span class="st">&quot;auc&quot;</span>)<span class="op">@</span>y.values[[<span class="dv">1</span>]]</code></pre>
<ul>
<li>Gráfico de la curva ROC para el <em>test</em></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#win.graph()</span>
<span class="kw">plot</span>( dt_test.perf , <span class="dt">col=</span><span class="st">&#39;red&#39;</span> , <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">type=</span><span class="st">&quot;l&quot;</span> , <span class="dt">main=</span><span class="st">&quot;Curva ROC modelo RF - test&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;Tasa de falsos positivos&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Tasa de verdaderos positivos&quot;</span>)
<span class="kw">abline</span>( <span class="dv">0</span> , <span class="dv">1</span>  , <span class="dt">col=</span><span class="st">&quot;blue&quot;</span> , <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">lty=</span><span class="dv">2</span>)
<span class="kw">abline</span>( <span class="dv">0</span> , <span class="dv">0</span> , <span class="dv">1</span> , <span class="dt">col=</span><span class="st">&quot;gray40&quot;</span>   , <span class="dt">lty=</span><span class="dv">3</span>)
<span class="kw">legend</span>( <span class="fl">0.4</span>, <span class="fl">0.2</span> , <span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;AUC (Random Forest)=&quot;</span>,<span class="kw">round</span>(rf1.test.auc,<span class="dv">4</span>)),<span class="st">&quot;AUC (Coin toss)=0.50&quot;</span>) ,<span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">lwd=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>) ,<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>)</code></pre>
<p><img src="02-Evaluation_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<blockquote>
<p>Métrica de error del clasificador RF:</p>
</blockquote>
<ul>
<li>Error tipo I (<span class="math inline">\(\alpha\)</span>): 22.50%, indica el error que se comete clasificando una pérdida ‘severa’ como ‘no severa’</li>
<li>Error tipo II (<span class="math inline">\(\beta\)</span>): 43.15%, indica el error que se comete clasificando una pérdida ‘no severa’ como ‘severa’</li>
<li>% mala clasificación (<span class="math inline">\(%mc\)</span>) : 40.66%, indica el % de veces que el modelo clasifica incorrectamente las pérdidas</li>
<li>Accuracy = <span class="math inline">\(100 - %\)</span>: 59.34%, indica el % de veces que el modelo acierta clasificando las pérdidas</li>
<li>Area bajo la curva ROC <span class="math inline">\(AUC\)</span>: 0.6988, medida global del poder de clasificación del modelo</li>
<li>Finalmente calculamos la curva ROC junto con la métrica AUC</li>
</ul>
<blockquote>
<p>Resumiendo:</p>
</blockquote>
<p>Una función útil para obtener rápidamente el análisis de un clasificador binario es la siguiente:</p>
<pre class="sourceCode r"><code class="sourceCode r">metricBinaryClass =<span class="st"> </span><span class="cf">function</span>( fitted.model , dataset , <span class="dt">cutpoint=</span><span class="ot">NULL</span> , <span class="dt">roc.graph=</span><span class="ot">TRUE</span>){
  
  <span class="co"># fitted.model : The Binary Classification model that is under evaluation. If provided, dataset contains all variables in the fitted model (target and predictors).</span>
  <span class="co"># dataset      : If fitted.model is not provided, dataset should has only two columns, predictions and labels.</span>
  <span class="co"># cuttpoint    : potimal cutoff or cutpoint to be used to split continuous predictions into two response categories of target variable</span>
  <span class="co"># roc.graph    : If true, ROC curve graph for the model is shown </span>
  
  <span class="co">#install.packages(&quot;binaryLogic&quot;)</span>
  <span class="kw">library</span>(binaryLogic)
  
  <span class="cf">if</span>( <span class="kw">missing</span>(fitted.model) <span class="op">|</span><span class="st"> </span><span class="kw">is.null</span>(fitted.model) ){
    
    tabl  &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(dataset)
  } 
  
  <span class="cf">else</span> {
    <span class="cf">if</span>( <span class="kw">class</span>(fitted.model)[<span class="dv">1</span>] <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;glm&#39;</span>,<span class="st">&#39;lm&#39;</span>,<span class="st">&#39;randomForest.formula&#39;</span>,<span class="st">&#39;randomForest&#39;</span>) ){
      tabl.pred &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">predict</span>( fitted.model, <span class="dt">newdata =</span> dataset ))
      tabl &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(tabl.pred[[<span class="dv">1</span>]], dataset[,<span class="st">&#39;Y&#39;</span>] )) 
      tabl &lt;-<span class="st"> </span>tabl[<span class="op">!</span><span class="kw">is.na</span>(tabl[[<span class="dv">1</span>]]),]
    }
    <span class="cf">if</span>( <span class="kw">class</span>(fitted.model)[<span class="dv">1</span>] <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;gbm&quot;</span>) ){
      tabl.pred &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">predict.gbm</span>( fitted.model , <span class="dt">newdata =</span> dataset , <span class="dt">n.trees =</span> <span class="dv">5000</span> , <span class="dt">type=</span><span class="st">&quot;response&quot;</span> ))
      tabl &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(tabl.pred[[<span class="dv">1</span>]], dataset[,<span class="st">&#39;Y&#39;</span>] )) 
      tabl &lt;-<span class="st"> </span>tabl[<span class="op">!</span><span class="kw">is.na</span>(tabl[[<span class="dv">1</span>]]),]
    }
    <span class="cf">if</span>( <span class="kw">class</span>(fitted.model)[<span class="dv">1</span>] <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;svm.formula&#39;</span>,<span class="st">&#39;svm&#39;</span>) ){
      tabl.pred &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">predict</span>( fitted.model, <span class="dt">newdata =</span> dataset ))
      ids_NAs &lt;-<span class="st"> </span><span class="kw">na.index</span>(dataset)
      tabl &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>( <span class="kw">cbind</span>(tabl.pred[[<span class="dv">1</span>]], dataset[<span class="op">-</span>ids_NAs,<span class="st">&#39;Y&#39;</span>]) ) 
      tabl &lt;-<span class="st"> </span>tabl[<span class="op">!</span><span class="kw">is.na</span>(tabl[[<span class="dv">1</span>]]),]
    }
  }
  <span class="kw">colnames</span>(tabl) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;predicted&#39;</span>,<span class="st">&#39;actual&#39;</span>)
  
  <span class="co"># ROCR objects</span>
  <span class="kw">require</span>(ROCR)
  obj.pred &lt;-<span class="st"> </span><span class="kw">prediction</span>(tabl<span class="op">$</span>predicted,tabl<span class="op">$</span>actual)
  obj.perf &lt;-<span class="st"> </span><span class="kw">performance</span>(obj.pred,<span class="st">&quot;tpr&quot;</span>,<span class="st">&quot;fpr&quot;</span>)
  obj.auc  &lt;-<span class="st"> </span><span class="kw">performance</span>(obj.pred,<span class="st">&quot;auc&quot;</span>)<span class="op">@</span>y.values[[<span class="dv">1</span>]]
  <span class="co"># For ROC curve:</span>
  obj.perf<span class="op">@</span>alpha.values[[<span class="dv">1</span>]][obj.perf<span class="op">@</span>alpha.values[[<span class="dv">1</span>]]<span class="op">==</span><span class="ot">Inf</span>] &lt;-<span class="st"> </span><span class="kw">max</span>(obj.perf<span class="op">@</span>alpha.values[[<span class="dv">1</span>]][obj.perf<span class="op">@</span>alpha.values[[<span class="dv">1</span>]]<span class="op">!=</span><span class="ot">Inf</span>])
  <span class="co"># KS criteria</span>
  KS.matrix=<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">abs</span>(obj.perf<span class="op">@</span>y.values[[<span class="dv">1</span>]]<span class="op">-</span>obj.perf<span class="op">@</span>x.values[[<span class="dv">1</span>]]), obj.perf<span class="op">@</span>alpha.values[[<span class="dv">1</span>]])
  <span class="co"># KS cutoff</span>
  <span class="co"># colnames(KS.matrix) &lt;- c(&quot;KS-distance&quot;,&quot;cut-point&quot;)</span>
  ind.ks  &lt;-<span class="st"> </span><span class="kw">sort</span>( KS.matrix[,<span class="dv">1</span>] , <span class="dt">index.return=</span><span class="ot">TRUE</span> )<span class="op">$</span>ix[<span class="kw">nrow</span>(KS.matrix)] 
  
  <span class="cf">if</span>( <span class="kw">missing</span>(cutpoint) <span class="op">|</span><span class="st"> </span><span class="kw">is.null</span>(cutpoint) ) cutpoint &lt;-<span class="st"> </span>KS.matrix[ind.ks,<span class="dv">2</span>]
  
  <span class="cf">if</span>( <span class="op">!</span>(<span class="kw">is.binary</span>(tabl)) ){
    
    <span class="co"># Make predictions objs.</span>
    <span class="co"># Binary metrics </span>
    tp =<span class="st"> </span><span class="kw">sum</span>( tabl<span class="op">$</span>predicted  <span class="op">&gt;</span><span class="st">  </span>cutpoint <span class="op">&amp;</span><span class="st"> </span>tabl<span class="op">$</span>actual <span class="op">&gt;</span><span class="st">  </span>cutpoint)
    fp =<span class="st"> </span><span class="kw">sum</span>( tabl<span class="op">$</span>predicted  <span class="op">&gt;</span><span class="st">  </span>cutpoint <span class="op">&amp;</span><span class="st"> </span>tabl<span class="op">$</span>actual <span class="op">&lt;=</span><span class="st"> </span>cutpoint)
    tn =<span class="st"> </span><span class="kw">sum</span>( tabl<span class="op">$</span>predicted  <span class="op">&lt;=</span><span class="st"> </span>cutpoint <span class="op">&amp;</span><span class="st"> </span>tabl<span class="op">$</span>actual <span class="op">&lt;=</span><span class="st"> </span>cutpoint)
    fn =<span class="st"> </span><span class="kw">sum</span>( tabl<span class="op">$</span>predicted  <span class="op">&lt;=</span><span class="st"> </span>cutpoint <span class="op">&amp;</span><span class="st"> </span>tabl<span class="op">$</span>actual <span class="op">&gt;</span><span class="st">  </span>cutpoint) 
    pos =<span class="st"> </span>tp<span class="op">+</span>fn
    neg =<span class="st"> </span>tn<span class="op">+</span>fp
    acc=<span class="st">  </span><span class="dv">100</span><span class="op">*</span>(tp<span class="op">+</span>tn)<span class="op">/</span>(pos<span class="op">+</span>neg)
    prec=<span class="st"> </span><span class="dv">100</span><span class="op">*</span>tp<span class="op">/</span>(tp<span class="op">+</span>fp)
    sens=<span class="st"> </span><span class="dv">100</span><span class="op">*</span>tp<span class="op">/</span>(tp<span class="op">+</span>fn) <span class="co"># = tpr = recall = 1 - error alpha</span>
    spec=<span class="st"> </span><span class="dv">100</span><span class="op">*</span>tn<span class="op">/</span>(tn<span class="op">+</span>fp) <span class="co"># 1- error beta</span>
    fpr =<span class="st"> </span><span class="dv">100</span><span class="op">*</span>fp<span class="op">/</span>neg  <span class="co"># error beta (tipo II) = 1 - spec</span>
    fnr =<span class="st"> </span><span class="dv">100</span><span class="op">*</span>fn<span class="op">/</span>pos  <span class="co"># error alpha (tipo I) = 1- recall = 1- sens</span>
  }
  
  <span class="cf">if</span>( <span class="kw">is.binary</span>(tabl) ){
    
    tp =<span class="st"> </span><span class="kw">sum</span>( tabl<span class="op">$</span>predicted  <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>tabl<span class="op">$</span>actual <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)
    fp =<span class="st"> </span><span class="kw">sum</span>( tabl<span class="op">$</span>predicted  <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>tabl<span class="op">$</span>actual <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)
    tn =<span class="st"> </span><span class="kw">sum</span>( tabl<span class="op">$</span>predicted  <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>tabl<span class="op">$</span>actual <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)
    fn =<span class="st"> </span><span class="kw">sum</span>( tabl<span class="op">$</span>predicted  <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>tabl<span class="op">$</span>actual <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) 
    pos =<span class="st"> </span>tp<span class="op">+</span>fn
    neg =<span class="st"> </span>tn<span class="op">+</span>fp
    acc=<span class="st">  </span><span class="dv">100</span><span class="op">*</span>(tp<span class="op">+</span>tn)<span class="op">/</span>(pos<span class="op">+</span>neg)
    prec=<span class="st"> </span><span class="dv">100</span><span class="op">*</span>tp<span class="op">/</span>(tp<span class="op">+</span>fp)
    sens=<span class="st"> </span><span class="dv">100</span><span class="op">*</span>tp<span class="op">/</span>(tp<span class="op">+</span>fn) <span class="co"># = tpr = recall = 1 - error alpha</span>
    spec=<span class="st"> </span><span class="dv">100</span><span class="op">*</span>tn<span class="op">/</span>(tn<span class="op">+</span>fp) <span class="co"># 1- error beta</span>
    fpr =<span class="st"> </span><span class="dv">100</span><span class="op">*</span>fp<span class="op">/</span>neg  <span class="co"># error beta (tipo II) = 1 - spec</span>
    fnr =<span class="st"> </span><span class="dv">100</span><span class="op">*</span>fn<span class="op">/</span>pos  <span class="co"># error alpha (tipo I) = 1- recall = 1- sens</span>
  }  
  
  <span class="cf">if</span>(roc.graph<span class="op">==</span><span class="ot">TRUE</span>){
    <span class="kw">win.graph</span>()
    <span class="kw">plot</span>( obj.perf  , <span class="dt">col=</span><span class="st">&#39;red&#39;</span> , <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;Tasa de falsos positivos&quot;</span> , <span class="dt">ylab=</span><span class="st">&quot;Tasa de verdaderos positivos&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Curva ROC modelo clasificación&quot;)</span>
<span class="st">    abline( 0.0 , 1.0 , col=&quot;</span>blue<span class="st">&quot;, lwd=2, lty=2)</span>
<span class="st">    abline( 0.0 , 0.0 , 1 , col=&quot;</span>gray40<span class="st">&quot; , lty=3)</span>
<span class="st">    legend( 0.45, 0.2 , c(paste0(&quot;</span><span class="kw">AUC</span> (Model)=<span class="st">&quot;,round(obj.auc,4)),&quot;</span><span class="kw">AUC</span> (Rolling dice)=<span class="fl">0.50</span><span class="st">&quot;) ,lty=c(1,2), lwd=c(2,2) ,col=c(&quot;</span>red<span class="st">&quot;,&quot;</span>blue<span class="st">&quot;), bty=&quot;</span>n<span class="st">&quot;)</span>
<span class="st">  }</span>
<span class="st">  </span>
<span class="st">  list(ClassError.tI=round(fnr,2), ClassError.tII=round(fpr,2), Accuracy=round(acc,2),Sensitivity = round(sens,2) , Specificity= round(spec,2), auc= obj.auc , Fisher.F1=round(2*prec*sens/(prec+sens),4) )</span>
<span class="st">  </span>
<span class="st">}</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">metricBinaryClass</span>( <span class="dt">fitted.model =</span> rf1 , <span class="dt">dataset=</span> dt_test , <span class="dt">cutpoint=</span>rf1.KScutoff , <span class="dt">roc.graph=</span><span class="ot">TRUE</span>)</code></pre>
<pre><code>## $ClassError.tI
## [1] 22.5
## 
## $ClassError.tII
## [1] 43.49
## 
## $Accuracy
## [1] 59.04
## 
## $Sensitivity
## [1] 77.5
## 
## $Specificity
## [1] 56.51
## 
## $auc
## [1] 0.7056507
## 
## $Fisher.F1
## [1] 31.3131</code></pre>
</div>
<div id="regresion" class="section level3">
<h3><span class="header-section-number">4.6.3</span> Regresión</h3>
<div class="info">
<p>Vamos a construir un modelo para prever las pérdidas.</p>
</div>
<blockquote>
<p>Modelo con <em>Random Forest</em> en <em>train</em></p>
</blockquote>
<pre class="sourceCode r"><code class="sourceCode r">fmla.rf2 &lt;-<span class="st"> </span><span class="kw">as.formula</span>(<span class="kw">paste0</span>(<span class="st">&#39;LOSS&#39;</span>,<span class="st">&#39;~&#39;</span>,<span class="kw">paste0</span>(<span class="kw">colnames</span>(df_autobi[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">8</span>)]),<span class="dt">collapse =</span> <span class="st">&quot;+&quot;</span>),<span class="dt">collapse =</span> <span class="st">&#39;&#39;</span>))
<span class="kw">set.seed</span>(<span class="dv">112233</span>) <span class="co">#recomendado</span>

rf2 &lt;-<span class="st"> </span><span class="kw">randomForest</span>( fmla.rf2,
                     <span class="dt">data =</span>dt_train,
                     <span class="dt">ntree =</span> <span class="dv">5000</span>,
                     <span class="dt">replace =</span><span class="ot">TRUE</span>,
                     <span class="dt">mtry=</span><span class="dv">4</span>,
                     <span class="dt">maxnodes =</span><span class="dv">50</span>,
                     <span class="dt">importance =</span> <span class="ot">TRUE</span>,
                     <span class="dt">na.action=</span>na.omit)

<span class="kw">summary</span>(rf2)</code></pre>
<pre><code>##                 Length Class  Mode     
## call               9   -none- call     
## type               1   -none- character
## predicted        759   -none- numeric  
## mse             5000   -none- numeric  
## rsq             5000   -none- numeric  
## oob.times        759   -none- numeric  
## importance        12   -none- numeric  
## importanceSD       6   -none- numeric  
## localImportance    0   -none- NULL     
## proximity          0   -none- NULL     
## ntree              1   -none- numeric  
## mtry               1   -none- numeric  
## forest            11   -none- list     
## coefs              0   -none- NULL     
## y                759   -none- numeric  
## test               0   -none- NULL     
## inbag              0   -none- NULL     
## terms              3   terms  call     
## na.action        179   omit   numeric</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(rf2)</code></pre>
<pre><code>## List of 19
##  $ call           : language randomForest(formula = fmla.rf2, data = dt_train, ntree = 5000, replace = TRUE,      mtry = 4, maxnodes = 50, imp| __truncated__
##  $ type           : chr &quot;regression&quot;
##  $ predicted      : Named num [1:759] 2.407 0.676 37.029 1.73 4.229 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:759] &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot; ...
##   ..- attr(*, &quot;na.action&quot;)= &#39;omit&#39; Named int [1:179] 1 9 19 25 27 40 43 46 50 51 ...
##   .. ..- attr(*, &quot;names&quot;)= chr [1:179] &quot;1&quot; &quot;10&quot; &quot;24&quot; &quot;30&quot; ...
##  $ mse            : num [1:5000] 566 483 441 401 427 ...
##  $ rsq            : num [1:5000] -0.707 -0.457 -0.328 -0.208 -0.286 ...
##  $ oob.times      : int [1:759] 1820 1870 1853 1846 1856 1840 1820 1899 1880 1876 ...
##  $ importance     : num [1:6, 1:2] 17.313 0.136 -3.726 3.199 4.752 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:6] &quot;ATTORNEY&quot; &quot;CLMSEX&quot; &quot;MARITAL&quot; &quot;CLMINSUR&quot; ...
##   .. ..$ : chr [1:2] &quot;%IncMSE&quot; &quot;IncNodePurity&quot;
##  $ importanceSD   : Named num [1:6] 1.215 1.018 1.116 0.38 0.743 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:6] &quot;ATTORNEY&quot; &quot;CLMSEX&quot; &quot;MARITAL&quot; &quot;CLMINSUR&quot; ...
##  $ localImportance: NULL
##  $ proximity      : NULL
##  $ ntree          : num 5000
##  $ mtry           : num 4
##  $ forest         :List of 11
##   ..$ ndbigtree    : int [1:5000] 99 99 99 99 99 99 99 99 99 99 ...
##   ..$ nodestatus   : int [1:99, 1:5000] -3 -3 -3 -3 -3 -3 -1 -3 -3 -3 ...
##   ..$ leftDaughter : int [1:99, 1:5000] 2 4 6 8 10 12 0 14 16 18 ...
##   ..$ rightDaughter: int [1:99, 1:5000] 3 5 7 9 11 13 0 15 17 19 ...
##   ..$ nodepred     : num [1:99, 1:5000] 4.96 4.6 23.76 7.19 1.9 ...
##   ..$ bestvar      : int [1:99, 1:5000] 5 1 6 3 6 3 0 6 2 3 ...
##   ..$ xbestsplit   : num [1:99, 1:5000] 1.5 1.5 37.5 3.5 20.5 1.5 0 25.5 1.5 1.5 ...
##   ..$ ncat         : Named int [1:6] 1 1 1 1 1 1
##   .. ..- attr(*, &quot;names&quot;)= chr [1:6] &quot;ATTORNEY&quot; &quot;CLMSEX&quot; &quot;MARITAL&quot; &quot;CLMINSUR&quot; ...
##   ..$ nrnodes      : int 99
##   ..$ ntree        : num 5000
##   ..$ xlevels      :List of 6
##   .. ..$ ATTORNEY: num 0
##   .. ..$ CLMSEX  : num 0
##   .. ..$ MARITAL : num 0
##   .. ..$ CLMINSUR: num 0
##   .. ..$ SEATBELT: num 0
##   .. ..$ CLMAGE  : num 0
##  $ coefs          : NULL
##  $ y              : Named num [1:759] 10.892 0.33 11.037 0.138 3.538 ...
##   ..- attr(*, &quot;na.action&quot;)= &#39;omit&#39; Named int [1:179] 1 9 19 25 27 40 43 46 50 51 ...
##   .. ..- attr(*, &quot;names&quot;)= chr [1:179] &quot;1&quot; &quot;10&quot; &quot;24&quot; &quot;30&quot; ...
##   ..- attr(*, &quot;names&quot;)= chr [1:759] &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot; ...
##  $ test           : NULL
##  $ inbag          : NULL
##  $ terms          :Classes &#39;terms&#39;, &#39;formula&#39;  language LOSS ~ ATTORNEY + CLMSEX + MARITAL + CLMINSUR + SEATBELT + CLMAGE
##   .. ..- attr(*, &quot;variables&quot;)= language list(LOSS, ATTORNEY, CLMSEX, MARITAL, CLMINSUR, SEATBELT, CLMAGE)
##   .. ..- attr(*, &quot;factors&quot;)= int [1:7, 1:6] 0 1 0 0 0 0 0 0 0 1 ...
##   .. .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. .. ..$ : chr [1:7] &quot;LOSS&quot; &quot;ATTORNEY&quot; &quot;CLMSEX&quot; &quot;MARITAL&quot; ...
##   .. .. .. ..$ : chr [1:6] &quot;ATTORNEY&quot; &quot;CLMSEX&quot; &quot;MARITAL&quot; &quot;CLMINSUR&quot; ...
##   .. ..- attr(*, &quot;term.labels&quot;)= chr [1:6] &quot;ATTORNEY&quot; &quot;CLMSEX&quot; &quot;MARITAL&quot; &quot;CLMINSUR&quot; ...
##   .. ..- attr(*, &quot;order&quot;)= int [1:6] 1 1 1 1 1 1
##   .. ..- attr(*, &quot;intercept&quot;)= num 0
##   .. ..- attr(*, &quot;response&quot;)= int 1
##   .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_GlobalEnv&gt; 
##   .. ..- attr(*, &quot;predvars&quot;)= language list(LOSS, ATTORNEY, CLMSEX, MARITAL, CLMINSUR, SEATBELT, CLMAGE)
##   .. ..- attr(*, &quot;dataClasses&quot;)= Named chr [1:7] &quot;numeric&quot; &quot;ordered&quot; &quot;ordered&quot; &quot;ordered&quot; ...
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:7] &quot;LOSS&quot; &quot;ATTORNEY&quot; &quot;CLMSEX&quot; &quot;MARITAL&quot; ...
##  $ na.action      : &#39;omit&#39; Named int [1:179] 1 9 19 25 27 40 43 46 50 51 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:179] &quot;1&quot; &quot;10&quot; &quot;24&quot; &quot;30&quot; ...
##  - attr(*, &quot;class&quot;)= chr [1:2] &quot;randomForest.formula&quot; &quot;randomForest&quot;</code></pre>
<blockquote>
<p>Importancia Relativa de las Variables <em>Input</em></p>
</blockquote>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">varImpPlot</span>(rf2,<span class="dt">sort =</span> T,<span class="dt">main=</span><span class="st">&quot;Variable Importance&quot;</span>)</code></pre>
<p><img src="02-Evaluation_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<blockquote>
<p>Previsión en <em>test</em></p>
</blockquote>
<pre class="sourceCode r"><code class="sourceCode r">rf2.prediction &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">predict</span>(rf2, <span class="dt">newdata =</span> dt_test))
dt_test<span class="op">$</span>pred_rf2 &lt;-<span class="st"> </span>rf2.prediction[[<span class="dv">1</span>]] </code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(dt_test, <span class="dv">3</span>)</code></pre>
<pre><code>##    ATTORNEY CLMSEX MARITAL CLMINSUR SEATBELT CLMAGE   LOSS Y  pred_rf1
## 6         1      2       1        2        1     35  0.309 0 0.2279703
## 12        1      1       1        2        1     42 29.620 1 0.2159590
## 18        1      1       1        2        1     58  0.758 0 0.2047155
##    pred_rf2
## 6  7.914295
## 12 8.539666
## 18 9.864992</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tail</span>(dt_test, <span class="dv">3</span>)</code></pre>
<pre><code>##      ATTORNEY CLMSEX MARITAL CLMINSUR SEATBELT CLMAGE  LOSS Y    pred_rf1
## 1336        2      1       2        2        1     NA 0.576 0          NA
## 1337        1      2       1        2        1     46 3.705 0 0.349066396
## 1339        1      2       2        1        1     18 3.277 0 0.004032191
##       pred_rf2
## 1336        NA
## 1337 36.877666
## 1339  3.963606</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(dt_test, <span class="dv">3</span>)</code></pre>
<pre><code>##  ATTORNEY  CLMSEX       MARITAL    CLMINSUR   SEATBELT       CLMAGE     
##  1:214    1   :180   2      :195   1   : 43   1   :385   Min.   : 0.00  
##  2:188    2   :219   (Other):200   2   :346   2   :  5   1st Qu.:19.00  
##           NA&#39;s:  3   NA&#39;s   :  7   NA&#39;s: 13   NA&#39;s: 12   Median :29.00  
##                                                          Mean   :31.31  
##                                                          3rd Qu.:42.00  
##                                                          Max.   :78.00  
##                                                          NA&#39;s   :55     
##       LOSS                 Y             pred_rf1          pred_rf2     
##  Min.   :   0.0050   Min.   :0.0000   Min.   :0.00005   Min.   : 0.377  
##  1st Qu.:   0.5175   1st Qu.:0.0000   1st Qu.:0.00797   1st Qu.: 2.048  
##  Median :   2.1645   Median :0.0000   Median :0.03794   Median : 3.293  
##  Mean   :   7.0917   Mean   :0.1144   Mean   :0.12531   Mean   : 6.375  
##  3rd Qu.:   3.7782   3rd Qu.:0.0000   3rd Qu.:0.21666   3rd Qu.: 7.881  
##  Max.   :1067.6970   Max.   :1.0000   Max.   :0.75036   Max.   :56.904  
##                                       NA&#39;s   :70        NA&#39;s   :70</code></pre>
<blockquote>
<p>Graficamos la distribución de los valores estimados en el <em>train</em></p>
</blockquote>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">density</span>(dt_test<span class="op">$</span>pred_rf2[<span class="op">!</span><span class="kw">is.na</span>(dt_test<span class="op">$</span>pred_rf2) <span class="op">&amp;</span><span class="st"> </span>dt_test<span class="op">$</span>pred_rf2 <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>]), <span class="dt">ylim=</span> <span class="kw">c</span>(<span class="dv">0</span>,.<span class="dv">25</span>) , <span class="dt">col=</span><span class="st">&quot;red&quot;</span> , <span class="dt">main=</span><span class="st">&quot;&quot;</span>)
<span class="kw">lines</span>(<span class="kw">density</span>(dt_test<span class="op">$</span>LOSS[dt_test<span class="op">$</span>LOSS<span class="op">&lt;</span><span class="dv">30</span>]),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">lty=</span><span class="dv">1</span>)</code></pre>
<p><img src="02-Evaluation_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">modelchecktest1 &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>( <span class="kw">cbind</span>(<span class="dt">real=</span>dt_test<span class="op">$</span>LOSS , <span class="dt">predicted=</span>dt_test<span class="op">$</span>pred_rf2) )
modelchecktest1[<span class="kw">is.na</span>(modelchecktest1)] &lt;-<span class="st"> </span><span class="dv">0</span>

<span class="kw">summary</span>(modelchecktest1)</code></pre>
<pre><code>##       real             predicted     
##  Min.   :   0.0050   Min.   : 0.000  
##  1st Qu.:   0.5175   1st Qu.: 1.310  
##  Median :   2.1645   Median : 2.422  
##  Mean   :   7.0917   Mean   : 5.265  
##  3rd Qu.:   3.7782   3rd Qu.: 7.469  
##  Max.   :1067.6970   Max.   :56.904</code></pre>
<blockquote>
<p>Error de ajuste del modelo</p>
</blockquote>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(modelchecktest1, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>) , <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>) ,  <span class="dt">pch=</span><span class="st">&quot;.&quot;</span> , <span class="dt">cex=</span><span class="fl">1.5</span>)
<span class="kw">segments</span>( <span class="dv">0</span>, <span class="dv">0</span> , <span class="dv">100</span>, <span class="dv">100</span> , <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</code></pre>
<p><img src="02-Evaluation_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<blockquote>
<p>Resumiendo</p>
</blockquote>
<p>Una función útil para medir el error:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">modelMetrics</span>(<span class="dt">real=</span>modelchecktest1<span class="op">$</span>real, <span class="dt">pred=</span>modelchecktest1<span class="op">$</span>predicted )</code></pre>
<pre><code>##  Accuracy metrics (global):</code></pre>
<pre><code>## MAE(ref) = 8.9208</code></pre>
<pre><code>## MAE = 7.765</code></pre>
<pre><code>## RMSE = 54.5686</code></pre>
<pre><code>## MAPE = 127.01</code></pre>
<pre><code>## MAPE(sim) = 68.65</code></pre>
<pre><code>## WMAPE = 109.49</code></pre>
<ul>
<li>Commentario: El error de ajuste del modelo de regresión es demasiado alto: <span class="math inline">\(RMSE= 54.57\)</span> y el <span class="math inline">\(MAPE=127.19%\)</span>
Con estos errores de predicción, es preferible utilizar a un modelo de clasificación en lugar de un modelo de regresión.</li>
</ul>
<div class="rmdcomment">
<p><strong>Ejercicio sugerido</strong></p>
<ul>
<li><p>Ajustar un Modelo de Regresión Logística para <span class="math inline">\(Y\)</span> y comparar los resultados con los proporcionados por el <em>Random Forest</em></p></li>
<li><p>Ajustar un Modelo de Regresión Lineal para <span class="math inline">\(LOSS\)</span> y comparar los resultados con los proporcionados por el <em>Random Forest</em></p></li>
</ul>
</div>

</div>
</div>
<!-- </div> -->



<div class="footnotes">
<hr />
<ol start="7">
<li id="fn7"><p>Si queremos cambiar la ruta, podemos hacer ‘myWd &lt;- setwd(“Ruta y Nombre de la carpeta”)’.<a href="practica-en-r.html#fnref7" class="footnote-back">↩</a></p></li>
<li id="fn8"><p><a href="https://CRAN.R-project.org/package=insuranceData" class="uri">https://CRAN.R-project.org/package=insuranceData</a><a href="practica-en-r.html#fnref8" class="footnote-back">↩</a></p></li>
<li id="fn9"><p><a href="https://www.rdocumentation.org/packages/insuranceData/versions/1.0/topics/AutoBi" class="uri">https://www.rdocumentation.org/packages/insuranceData/versions/1.0/topics/AutoBi</a><a href="practica-en-r.html#fnref9" class="footnote-back">↩</a></p></li>
<li id="fn10"><p>A loss is the injury or damage sustained by the insured in consequence of the happening of one or more of the accidents or misfortunes against which the insurer, in consideration of the premium, has undertaken to indemnify the insured.<a href="practica-en-r.html#fnref10" class="footnote-back">↩</a></p></li>
<li id="fn11"><p>The interquartile range of an observation variable is the difference of its upper and lower quartiles. It is a measure of how far apart the middle portion of data spreads in value<a href="practica-en-r.html#fnref11" class="footnote-back">↩</a></p></li>
<li id="fn12"><p><a href="https://www.rdocumentation.org/packages/randomForest/versions/4.6-12/topics/randomForest" class="uri">https://www.rdocumentation.org/packages/randomForest/versions/4.6-12/topics/randomForest</a><a href="practica-en-r.html#fnref12" class="footnote-back">↩</a></p></li>
<li id="fn13"><p><a href="https://www.r-bloggers.com/a-small-introduction-to-the-rocr-package/" class="uri">https://www.r-bloggers.com/a-small-introduction-to-the-rocr-package/</a><a href="practica-en-r.html#fnref13" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="metodos-de-re-muestreo.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="regresion-lineal.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/lunr.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
